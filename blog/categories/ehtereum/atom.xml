<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ehtereum | Hacker and Geeker's Way]]></title>
  <link href="http://zhaozhiming.github.io/blog/categories/ehtereum/atom.xml" rel="self"/>
  <link href="http://zhaozhiming.github.io/"/>
  <updated>2018-04-29T17:02:08+08:00</updated>
  <id>http://zhaozhiming.github.io/</id>
  <author>
    <name><![CDATA[赵芝明]]></name>
    <email><![CDATA[kingzzm1982@sina.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[如何使用 Etherscan 的 API]]></title>
    <link href="http://zhaozhiming.github.io/blog/2018/04/20/how-to-use-etherscan-api/"/>
    <updated>2018-04-20T20:51:00+08:00</updated>
    <id>http://zhaozhiming.github.io/blog/2018/04/20/how-to-use-etherscan-api</id>
    <content type="html"><![CDATA[<p><img src="/images/post/2018/04/etherscan.png" width="400" height="300"></p>

<p>虽然以太坊提供了 <a href="https://github.com/ethereum/wiki/wiki/JavaScript-API">Web3</a> 和 <a href="https://github.com/ethereum/wiki/wiki/JSON-RPC">Json Rpc</a> 这 2 种 API，geth 也额外提供了一些 <a href="https://github.com/ethereum/go-ethereum/wiki/Management-APIs">API</a>，但是对于开发以太坊应用来说还是显得有些不足，比如说获取交易记录的时间，需要先通过交易的 hash 找到该交易对应的区块 id，然后才能找到对应的时间，查询起来相当不方便。</p>

<p>好在<code>Etherscan</code>对外提供了一些公共的 API，给我们提供了额外的能力来处理更多的业务场景。</p>

<!--more-->


<h2>Etherscan api</h2>

<p>为了方便开发人员更好地使用<code>ethersacn.io</code>，网站提供了<a href="https://etherscan.io/apis">一系列 API</a> 供开发人员使用。</p>

<h3>使用方法</h3>

<p>API 的使用非常简单，基本上都是 get 方法，通过 http 请求就可以直接调用，在每个 Api 的说明文档都有对应的例子可以查看。</p>

<h3>模块介绍</h3>

<p>API 主要包含以下模块：账号、智能合约、交易、区块、事件日志、代币及工具等。</p>

<h3>账号 API</h3>

<p>账号相关的 API，有获取账号金额，获取交易记录等，该模块提供的 API 最多。</p>

<h4>获取单个账号金额</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=balance&amp;amp;address=0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&amp;amp;tag=latest&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>balance&amp;amp;address<span class="o">=</span>0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&amp;amp;tag<span class="o">=</span>latest&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<ul>
<li>module：对应的模块名称，这里是账户模块，所以是<code>moudle=account</code></li>
<li>action：对应的操作，这里是<code>balance</code>，即获取金额。</li>
<li>address：要查询金额的账号地址。</li>
<li>tag：之前在介绍 geth 的 API 时讲过获取账号金额需要 2 个参数，一个是账号地址，另外一个就是 tag，一般写<code>latest</code>就可以了。</li>
<li>apikey：你在<code>Etherscan</code>上创建的 apikey，带上没有请求的限制，也可以不带，下面会介绍 API 的请求限制。</li>
</ul>


<p>其中<code>module、action、apikey</code>是每个 API 都有的参数，其他的参数则因不同 API 而不同。</p>

<p><em>返回结果</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&amp;ldquo;status&amp;rdquo;:&amp;ldquo;1&amp;rdquo;,&amp;ldquo;message&amp;rdquo;:&amp;ldquo;OK&amp;rdquo;,&amp;ldquo;result&amp;rdquo;:&amp;ldquo;670456215218885498951364&amp;rdquo;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>获取多个账号金额</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=balancemulti&amp;amp;address=0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a,0x63a9975ba31b0b9626b34300f7f627147df1f526,0x198ef1ec325a96cc354c7266a038be8b5c558f67&amp;amp;tag=latest&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>balancemulti&amp;amp;address<span class="o">=</span>0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a,0x63a9975ba31b0b9626b34300f7f627147df1f526,0x198ef1ec325a96cc354c7266a038be8b5c558f67&amp;amp;tag<span class="o">=</span>latest&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<p>（前面有讲过的参数就不讲了，下同）</p>

<p>与单个账号金额 API 相比，参数<code>address</code>用<code>,</code>号分隔多个账号，最多可支持 20 个账号的金额查询。</p>

<p><em>返回结果</em>
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;<span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;OK&quot;</span>,
</span><span class='line'><span class="s2">&quot;result&quot;</span>: <span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;account&quot;</span>: <span class="s2">&quot;0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;balance&quot;</span>: <span class="s2">&quot;40807168564070000000000&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;account&quot;</span>: <span class="s2">&quot;0x63a9975ba31b0b9626b34300f7f627147df1f526&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;balance&quot;</span>: <span class="s2">&quot;332567136222827062478&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;account&quot;</span>: <span class="s2">&quot;0x198ef1ec325a96cc354c7266a038be8b5c558f67&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;balance&quot;</span>: <span class="s2">&quot;0&quot;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">]</span>,
</span><span class='line'><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;1&quot;</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>获取"正常"交易记录</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=txlist&amp;amp;address=0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&amp;amp;startblock=0&amp;amp;endblock=99999999&amp;amp;page=1&amp;amp;offset=10&amp;amp;sort=asc&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>txlist&amp;amp;address<span class="o">=</span>0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&amp;amp;startblock<span class="o">=</span>0&amp;amp;endblock<span class="o">=</span>99999999&amp;amp;page<span class="o">=</span>1&amp;amp;offset<span class="o">=</span>10&amp;amp;sort<span class="o">=</span>asc&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<ul>
<li>action：为<code>txlist</code>，表示列出交易记录。</li>
<li>address：要查询交易记录的账号地址。</li>
<li>startblock：起始查询块 id，可选，默认值为 0。</li>
<li>endblock：结束查询块 id，可选，默认值为最后一个区块。</li>
<li>page: 页数（没错，这个 API 还支持分页），可选。</li>
<li>offset: 查询到记录数，可选，默认是查询 10000 条记录。</li>
<li>sort: 排序规则，可以正序<code>asc</code>和倒序<code>desc</code>。</li>
</ul>


<p><em>返回结果</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;<span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;OK&quot;</span>,
</span><span class='line'><span class="s2">&quot;result&quot;</span>: <span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;blockHash&quot;</span>: <span class="s2">&quot;0x2d0a9228f22fe85596d246040d4fd7dc6b1a55920bae02b68e731d55a890b315&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;blockNumber&quot;</span>: <span class="s2">&quot;47894&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;confirmations&quot;</span>: <span class="s2">&quot;5435815&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;contractAddress&quot;</span>: <span class="s2">&quot;&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;cumulativeGasUsed&quot;</span>: <span class="s2">&quot;21612&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;from&quot;</span>: <span class="s2">&quot;0xddbd2b932c763ba5b1b7ae3b362eac3e8d40121a&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gas&quot;</span>: <span class="s2">&quot;23000&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gasPrice&quot;</span>: <span class="s2">&quot;400000000000&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gasUsed&quot;</span>: <span class="s2">&quot;21612&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;hash&quot;</span>: <span class="s2">&quot;0x7e1503d2001cab2f432b56a62a3ee874782c8e33cbd79a664d155a758c1784a2&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;input&quot;</span>: <span class="s2">&quot;0x454e34354139455138&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;isError&quot;</span>: <span class="s2">&quot;0&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;nonce&quot;</span>: <span class="s2">&quot;1&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;timeStamp&quot;</span>: <span class="s2">&quot;1438948043&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;to&quot;</span>: <span class="s2">&quot;0x2910543af39aba0cd09dbb2d50200b3e800a63d2&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;transactionIndex&quot;</span>: <span class="s2">&quot;0&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;txreceipt_status&quot;</span>: <span class="s2">&quot;&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;value&quot;</span>: <span class="s2">&quot;9001000000000000000000&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'><span class="o">]</span>,
</span><span class='line'><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;1&quot;</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>获取"内部"交易记录</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=txlistinternal&amp;amp;address=0x2c1ba59d6f58433fb1eaee7d20b26ed83bda51a3&amp;amp;startblock=0&amp;amp;endblock=2702578&amp;amp;page=1&amp;amp;offset=10&amp;amp;sort=asc&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>txlistinternal&amp;amp;address<span class="o">=</span>0x2c1ba59d6f58433fb1eaee7d20b26ed83bda51a3&amp;amp;startblock<span class="o">=</span>0&amp;amp;endblock<span class="o">=</span>2702578&amp;amp;page<span class="o">=</span>1&amp;amp;offset<span class="o">=</span>10&amp;amp;sort<span class="o">=</span>asc&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<p>参数与上一个 API 基本相同，只有<code>action</code>是<code>txlistinternal</code>这一点不同，这 2 种交易的区别是什么呢？简单的理解就是“正常”的交易是会记录到区块链上的，而“内部”交易是指不会记录到区块链上的记录，比如交易失败的记录。</p>

<p>另外这个 API 还可以通过交易 hash 查看交易的详情。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=txlistinternal&amp;amp;txhash=0x40eb908387324f2b575b4879cd9d7188f69c8fc9d87c901b9e2daaea4b442170&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>txlistinternal&amp;amp;txhash<span class="o">=</span>0x40eb908387324f2b575b4879cd9d7188f69c8fc9d87c901b9e2daaea4b442170&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>返回结果</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;<span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;OK&quot;</span>,
</span><span class='line'><span class="s2">&quot;result&quot;</span>: <span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;blockNumber&quot;</span>: <span class="s2">&quot;2547619&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;contractAddress&quot;</span>: <span class="s2">&quot;&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;errCode&quot;</span>: <span class="s2">&quot;Bad jump destination&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;from&quot;</span>: <span class="s2">&quot;0x2c1ba59d6f58433fb1eaee7d20b26ed83bda51a3&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gas&quot;</span>: <span class="s2">&quot;346878&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gasUsed&quot;</span>: <span class="s2">&quot;0&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;hash&quot;</span>: <span class="s2">&quot;0x2896441f9d1f167b4a3f987d82233e7d238e6a50a227c4b612dbc82f34bb533d&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;input&quot;</span>: <span class="s2">&quot;&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;isError&quot;</span>: <span class="s2">&quot;1&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;timeStamp&quot;</span>: <span class="s2">&quot;1478013203&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;to&quot;</span>: <span class="s2">&quot;0x20d42f2e99a421147acf198d775395cac2e8b03d&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;traceId&quot;</span>: <span class="s2">&quot;0&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;call&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;value&quot;</span>: <span class="s2">&quot;71000000000000000000&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'><span class="o">]</span>,
</span><span class='line'><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;1&quot;</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>获取 ERC20 代币交易事件记录</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=tokentx&amp;amp;contractaddress=0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2&amp;amp;address=0x4e83362442b8d1bec281594cea3050c8eb01311c&amp;amp;page=1&amp;amp;offset=100&amp;amp;sort=asc&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>tokentx&amp;amp;contractaddress<span class="o">=</span>0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2&amp;amp;address<span class="o">=</span>0x4e83362442b8d1bec281594cea3050c8eb01311c&amp;amp;page<span class="o">=</span>1&amp;amp;offset<span class="o">=</span>100&amp;amp;sort<span class="o">=</span>asc&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<ul>
<li>action: 值为<code>tokentx</code>，表示查询代币交易记录。</li>
<li>contractaddress: 代币的智能合约地址。</li>
<li>address: 只查询和该账户地址相关的记录，可选。</li>
</ul>


<p><em>返回结果</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;<span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;OK&quot;</span>,
</span><span class='line'><span class="s2">&quot;result&quot;</span>: <span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;blockHash&quot;</span>: <span class="s2">&quot;0xb3ff25909ae9ae5b65baecab1114dff885fbd5a1607081229ea50b6a2db13ae8&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;blockNumber&quot;</span>: <span class="s2">&quot;5278009&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;confirmations&quot;</span>: <span class="s2">&quot;205861&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;contractAddress&quot;</span>: <span class="s2">&quot;0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;cumulativeGasUsed&quot;</span>: <span class="s2">&quot;1050219&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;from&quot;</span>: <span class="s2">&quot;0x4e83362442b8d1bec281594cea3050c8eb01311c&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gas&quot;</span>: <span class="s2">&quot;191157&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gasPrice&quot;</span>: <span class="s2">&quot;4000000000&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;gasUsed&quot;</span>: <span class="s2">&quot;97646&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;hash&quot;</span>: <span class="s2">&quot;0x497f15095877bc06b9e0f422673c1e0f13a2b4224b615ef29ce8c46e249364d1&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;input&quot;</span>: <span class="s2">&quot;0x73b38101000000000000000000000000000000000000000000000000000000000000003d0000000000000000000000000000000000000000000046aefaa28844d7d839d7&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;nonce&quot;</span>: <span class="s2">&quot;730&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;timeStamp&quot;</span>: <span class="s2">&quot;1521386734&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;to&quot;</span>: <span class="s2">&quot;0x69076e44a9c70a67d5b79d95795aba299083c275&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;tokenDecimal&quot;</span>: <span class="s2">&quot;18&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;tokenName&quot;</span>: <span class="s2">&quot;Maker&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;tokenSymbol&quot;</span>: <span class="s2">&quot;MKR&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;transactionIndex&quot;</span>: <span class="s2">&quot;28&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;value&quot;</span>: <span class="s2">&quot;553365126770755906&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'><span class="o">]</span>,
</span><span class='line'><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;1&quot;</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>获取已开采的区块列表</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=account&amp;amp;action=getminedblocks&amp;amp;address=0x9dd134d14d1e65f84b706d6f205cd5b1cd03a46b&amp;amp;blocktype=blocks&amp;amp;page=1&amp;amp;offset=10&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>account&amp;amp;action<span class="o">=</span>getminedblocks&amp;amp;address<span class="o">=</span>0x9dd134d14d1e65f84b706d6f205cd5b1cd03a46b&amp;amp;blocktype<span class="o">=</span>blocks&amp;amp;page<span class="o">=</span>1&amp;amp;offset<span class="o">=</span>10&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<ul>
<li>action: 值为<code>getminedblocks</code>。</li>
<li>blocktype：区块类型，可以选区块<code>blocks</code>和叔块<code>uncles</code>，不了解叔块的可以查看<a href="https://www.bixuncn.com/baike/block/1141.html">这里</a>。</li>
</ul>


<p><em>返回结果</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="o">{</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;<span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;OK&quot;</span>,
</span><span class='line'><span class="s2">&quot;result&quot;</span>: <span class="o">[</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="s2">&quot;blockNumber&quot;</span>: <span class="s2">&quot;3462296&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;blockReward&quot;</span>: <span class="s2">&quot;5194770940000000000&quot;</span>,
</span><span class='line'>        <span class="s2">&quot;timeStamp&quot;</span>: <span class="s2">&quot;1491118514&quot;</span>
</span><span class='line'>    <span class="o">}</span>,
</span><span class='line'><span class="o">]</span>,
</span><span class='line'><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;1&quot;</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>合同 API</h3>

<p>智能合约相关的 API，其实只有一个获取智能合约接口的 API，但是这个 API 非常有用。</p>

<h4>获取智能合约接口</h4>

<p><em>API 示例</em></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.etherscan.io/api?module=contract&amp;amp;action=getabi&amp;amp;address=0xBB9bc244D798123fDe783fCc1C72d3Bb8C189413&amp;amp;apikey=YourApiKeyToken&quot;</span>&gt;https://api.etherscan.io/api?module<span class="o">=</span>contract&amp;amp;action<span class="o">=</span>getabi&amp;amp;address<span class="o">=</span>0xBB9bc244D798123fDe783fCc1C72d3Bb8C189413&amp;amp;apikey<span class="o">=</span>YourApiKeyToken&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>参数说明</em></p>

<ul>
<li>module: 值为<code>contract</code>。</li>
<li>action: 值为<code>getabi</code>。</li>
<li>address: 智能合约地址。</li>
</ul>


<p>智能合约的 abi 就是一个 json 对象，通过这个对象我们可以调用其接口方法，后面会写一篇文章介绍如何操作 abi 对象，敬请期待。</p>

<p><em>返回结果</em></p>

<p>返回结果内容比较长，这里省略，就是一个 json 对象，感兴趣的可以自行调用该 API 看结果。</p>

<h3>使用限制</h3>

<p>账号和智能合约的 API 已经能满足大部分的业务需求了，其他模块的 API 感觉没什么太大的作用，这里就不介绍了，感兴趣的读者可以自行查阅。</p>

<p>这里再说下 API 的使用限制，刚才提到每个 API 都有一个<code>apikey</code>参数，如果 API 没加上这个参数的话，每个 API 的请求次数不能超过 5 次每秒。</p>

<h2>总结</h2>

<p><code>Etherscan</code>提供的这些 API 有些是和以太坊提供的 API 有重复的，比如说获取账号金额，获取事件日志记录等，但有一些 API 给我们带来了很大的便利性，比如获取账号交易记录，有了这个 API 就不用使用几个原生 API 进行各种数据拼接了。</p>

<p>另外<code>Etherscan</code>的这套 API 在 Rinkeby 测试网络也有一套一模一样的，区别只是前面的 url 不同，Rinkeby 的是：<code>api-rinkeby.etherscan.io</code>，感兴趣的同学可以去试试。</p>
]]></content>
  </entry>
  
</feed>
