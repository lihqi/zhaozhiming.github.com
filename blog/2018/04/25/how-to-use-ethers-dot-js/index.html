
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>ä»¥å¤ªåŠå·¥å…·åŒ… Ethers.js ä½¿ç”¨ä»‹ç» - Hacker and Geeker's Way</title>
    <meta name="author" content="èµµèŠæ˜">
    
	<meta name="description" content="ä»¥å¤ªåŠå·¥å…·åŒ… Ethers.js ä½¿ç”¨ä»‹ç»">
	<meta name="keywords" content="ethereum,ethersjs">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Hacker and Geeker's Way" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='/stylesheets/slackey.css' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/fjalla_one.css' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/amethysta.css' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/css_grid.css' rel='stylesheet' type='text/css'>
	  <script src="https://cdn.staticfile.org/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <script src="/javascripts/ajaxify.js"></script>
   
    <link href="https://cdn.staticfile.org/semantic-ui/0.10.0/css/semantic.min.css" rel="stylesheet" type="text/css">

<script src="https://cdn.staticfile.org/semantic-ui/0.10.0/javascript/semantic.min.js"></script>
<script src="/javascripts/monthly_archive.js"></script>

    
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-100485541-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
<div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Hacker and Geeker's Way
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  
  <!-- GitHub -->
  <li>
  <a href="https://github.com/zhaozhiming" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a href="http://www.twitter.com/kingzzm" class="twitter" title="Twitter"></a>
  </li>
  
  
  <!-- LinkedIn -->
  <li>
  <a href="http://www.linkedin.com/in/zhaozhiming" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  
  
  
  <!-- Stackoverflow -->
  <li>
  <a href="http://stackoverflow.com/users//1954315/zhaozhiming" class="stackoverflow" title="Stackoverflow"></a>
  </li>
  
  
  <!-- wechat -->
  <li class="wechat">
  <a href="#" class="wechat" title="Wechat">
    <i class="wechat-qr"></i>
  </a>
  </li>
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/blog/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

	<div id="toload">
		<div id="content">
			<div class="inner">
	<article class="post">
	<h2 class="title">ä»¥å¤ªåŠå·¥å…·åŒ… Ethers.js ä½¿ç”¨ä»‹ç»</h2>
	<div class="entry-content"><p><img src="/images/post/2018/04/ethers.png" width="400" height="300"></p>

<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä»‹ç»è¿‡ï¼Œä»¥å¤ªåŠæä¾›äº†ä¸¤ç§å½¢å¼çš„ APIï¼Œä¸€ç§æ˜¯ <a href="https://github.com/ethereum/wiki/wiki/JSON-RPC">JSON RPC</a>ï¼Œå¦å¤–ä¸€ç§æ˜¯ <a href="https://github.com/ethereum/wiki/wiki/JavaScript-API">Javascript API</a> â€”â€” é€šè¿‡ Web3 è¿™ä¸ªå·¥å…·åŒ…è¿›è¡Œ API è°ƒç”¨ï¼ŒWeb3 åŠŸèƒ½å¼ºå¤§ä½†ç¼ºç‚¹å°±æ˜¯è´¦å·ç›¸å…³çš„ API æ¯”è¾ƒå°‘ï¼Œè€Œä¸”å®ƒåº•å±‚ç”¨åˆ°äº†ä¸€äº› Node åŸç”Ÿåº“çš„ä¾èµ–ï¼Œå¯¼è‡´å…¶åœ¨ React Nativeï¼ˆä»¥ä¸‹ç®€ç§° RNï¼‰ ä¸­ä½¿ç”¨ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œå› ä¸º Node å’Œ RN æ˜¯ 2 ä¸ªä¸åŒçš„ç¯å¢ƒã€‚</p>

<p>æ‰€ä»¥ä»Šå¤©ç»™å¤§å®¶ä»‹ç»å¦å¤–ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ JS ä»¥å¤ªåŠå·¥å…·åº“â€”â€”<a href="https://github.com/ethers-io/ethers.js/">Ethers.js</a>ã€‚</p>

<!--more-->


<h2>ç®€ä»‹</h2>

<p>Ethers.js çš„å®˜æ–¹ä»‹ç»æ˜¯è¿™æ ·çš„â€”â€”é’ˆå¯¹ä»¥å¤ªåŠé’±åŒ…åŠŸèƒ½å®Œæ•´å®ç°çš„å·¥å…·åŒ…ï¼Œå…¶ API æ–‡æ¡£ä¹Ÿååˆ†è¯¦å°½ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹<a href="https://docs.ethers.io/ethers.js/html/">è¿™é‡Œ</a>ã€‚</p>

<p>åœ¨ä»“åº“ç»´æŠ¤ä¸Šä½œè€…æ¯”è¾ƒç”¨å¿ƒï¼Œissue éƒ½èƒ½åŠæ—¶è§£ç­”ï¼Œæ›´æ–°ä¹Ÿæ¯”è¾ƒé¢‘ç¹ï¼Œå¦‚æœè§‰å¾—è¿™ä¸ªåº“è¿˜ä¸é”™çš„å¯ä»¥è€ƒè™‘ç»™ä½œè€…ä¸€äº› Eth æèµ ï¼Œè¿™æ˜¯ä½œè€…çš„ä»¥å¤ªåŠè´¦æˆ·åœ°å€ï¼š<code>0xEA517D5a070e6705Cc5467858681Ed953d285Eb9</code>ã€‚</p>

<h2>åˆ›å»º / å¯¼å…¥é’±åŒ…</h2>

<p>ä¸ Web3 ç›¸æ¯” Ethers.js çš„è´¦å·ç›¸å…³ API æ¯”è¾ƒä¸°å¯Œï¼Œåœ¨æ–‡æ¡£ä»‹ç»ä¸­ï¼Œè¿™ä¸€ç±» API å«<code>é’±åŒ…</code>APIï¼Œé’±åŒ…å°±æ˜¯è´¦æˆ·çš„æ„æ€ï¼Œåˆ›å»ºé’±åŒ…æœ‰ä»¥ä¸‹æ–¹å¼ï¼š</p>

<h3>åˆ›å»ºéšæœºåœ°å€çš„é’±åŒ…</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="nx">Wallet</span><span class="p">.</span><span class="nx">createRandom</span><span class="p">();</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</span><span class='line'><span class="c1">// &quot;æ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸ä¸€æ ·çš„é’±åŒ…åœ°å€&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>é€šè¿‡æ˜æ–‡ç§é’¥åˆ›å»ºé’±åŒ…</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="s2">&quot;0x0123456789012345678901234567890123456789012345678901234567890123&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Wallet</span><span class="p">(</span><span class="nx">privateKey</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</span><span class='line'><span class="c1">// &quot;Address: 0x14791697260E4c9A71f18484C9f997B308e59325&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>é€šè¿‡åŠ©è®°è¯åˆ›å»ºé’±åŒ…</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;radar blur cabbage chef fix engine embark joy scheme fiction master release&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="nx">Wallet</span><span class="p">.</span><span class="nx">fromMnemonic</span><span class="p">(</span><span class="nx">mnemonic</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</span><span class='line'><span class="c1">// &quot;Address: 0xaC39b311DCEb2A4b2f5d8461c1cdaF756F4F7Ae9&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>é€šè¿‡ keystore åˆ›å»ºé’±åŒ…</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// keystore æ˜¯ä¸€ä¸ª json</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">json</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">keystore</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">Wallet</span><span class="p">.</span><span class="nx">fromEncryptedWallet</span><span class="p">(</span><span class="nx">json</span><span class="p">,</span> <span class="nx">password</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">wallet</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">// &quot;Address: 0x88a5C2d9919e46F883EB62F7b8Dd9d0CC45bc290&quot;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ï¼šè¿™ç§æ–¹å¼åœ¨ RN ç¯å¢ƒä¸­æ‰§è¡Œæ•ˆç‡éå¸¸ä½ï¼Œåœ¨ç”µè„‘ä¸Šæ‰§è¡Œåªè¦ 5 ç§’ä¸åˆ°ï¼Œä½†åœ¨ RN ä¸Šè¦æ‰§è¡Œå·®ä¸å¤š 5 åˆ†é’Ÿã€‚</p>

<h3>åˆ›å»ºè„‘è®°å¿†çš„é’±åŒ…</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="s2">&quot;support@ethers.io&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="s2">&quot;password123&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">Wallet</span><span class="p">.</span><span class="nx">fromBrainWallet</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">wallet</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Address: &quot;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">// &quot;Address: 0x7Ee9AE2a2eAF3F0df8D323d555479be562ac4905&quot;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>è„‘è®°å¿†æ–¹å¼å…¶å®å°±æ˜¯ç”¨æˆ·åå’Œå¯†ç çš„æ–¹æ³•ï¼ŒåŒæ ·è¿™ç§æ–¹å¼åœ¨ RN ç¯å¢ƒæ‰§è¡Œæ•ˆç‡ä¹Ÿå¾ˆå·®ã€‚</p>

<h2>å¯¼å‡ºé’±åŒ…</h2>

<p>å¯¼å‡ºé’±åŒ…ä¹Ÿæ˜¯é’±åŒ…åº”ç”¨çš„ä¸€ä¸ªä¸»è¦ä¸šåŠ¡åœºæ™¯ï¼Œåˆ†åˆ«æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p>

<h3>å¯¼å‡ºæ˜æ–‡ç§é’¥</h3>

<p>å› ä¸ºæ¯ä¸ªé’±åŒ…å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>privateKey</code>å±æ€§ï¼Œæ‰€ä»¥å¯¼å‡ºç§é’¥åªè¦ç›´æ¥è·å–è¿™ä¸ªå±æ€§å°±å¯ä»¥äº†ã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="nx">Wallet</span><span class="p">.</span><span class="nx">createRandom</span><span class="p">();</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å¯¼å‡ºç§é’¥ï¼š&#39;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">privateKey</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>å¯¼å‡ºåŠ©è®°è¯</h3>

<p>è·Ÿç§é’¥ä¸åŒï¼Œä¸æ˜¯æ¯ä¸ªé’±åŒ…å¯¹è±¡éƒ½æœ‰åŠ©è®°è¯å±æ€§ï¼Œåªæœ‰é€šè¿‡åŠ©è®°è¯å¯¼å…¥çš„é’±åŒ…å¯¹è±¡æœ‰åŠ©è®°è¯<code>mnemonic</code>å±æ€§ã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">mnemonic</span> <span class="o">=</span> <span class="s2">&quot;radar blur cabbage chef fix engine embark joy scheme fiction master release&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="nx">Wallet</span><span class="p">.</span><span class="nx">fromMnemonic</span><span class="p">(</span><span class="nx">mnemonic</span><span class="p">);</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å¯¼å‡ºåŠ©è®°è¯ï¼š&#39;</span> <span class="o">+</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">mnemonic</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>å¯¼å‡º keystore</h3>

<p>é’±åŒ…å¯¹è±¡æœ‰ä¸€ä¸ª<code>encrypt</code>æ–¹æ³•å¯ä»¥å¯¼å‡ºé’±åŒ…çš„ keystoreï¼Œä½†è¯¥æ–¹æ³•åœ¨ RN ç¯å¢ƒä¸­åŒæ ·å­˜åœ¨æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">password</span> <span class="o">=</span> <span class="s2">&quot;password123&quot;</span><span class="p">;</span>
</span><span class='line'><span class="c1">// å›è°ƒå‡½æ•°å¯ä»¥è·å–å¯¼å‡ºè¿›åº¦</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">percent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Encrypting: &quot;</span> <span class="o">+</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">percent</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;% complete&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">keystore</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å¯¼å‡º keystoreï¼š&#39;</span> <span class="o">+</span> <span class="nx">keystore</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Provider</h2>

<p>é’±åŒ…çš„åˆ›å»ºæ˜¯ç¦»çº¿çš„ï¼Œä¸éœ€è¦ä¾èµ–ç½‘ç»œå³å¯åˆ›å»ºé’±åŒ…åœ°å€ï¼Œä½†å¦‚æœæƒ³è·å–é’±åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚é‡‘é¢ã€äº¤æ˜“è®°å½•ï¼Œåˆæˆ–è€…æƒ³å¹¿æ’­äº¤æ˜“çš„è¯ï¼Œå°±éœ€è¦è®©é’±åŒ…è¿ä¸Šä»¥å¤ªåŠçš„ç½‘ç»œäº†ã€‚</p>

<p>åœ¨ Web3 ä¸­æ˜¯ç”¨ provider æ¥è¿›è¡Œç½‘ç»œè¿æ¥çš„ï¼ŒEthers.js ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè€Œä¸” Ethers.js æä¾›äº†é›†æˆå¤šç§ Provider çš„æ–¹å¼ã€‚</p>

<h3>Provider ç±»å‹</h3>

<ul>
<li>Etherscan Providerï¼šè¿æ¥ Etherscan API çš„ providerï¼Œéœ€è¦ 2 ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ç½‘ç»œåç§°ï¼Œä¸€ä¸ªæŸ¥è¯¢ API æ‰€éœ€çš„ tokenï¼ˆä¹‹å‰çš„æ–‡ç« æœ‰è®²è¿‡ï¼ŒæŸ¥è¯¢ Etherscan çš„ API æ—¶ apitoken ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†å¦‚æœæ²¡æœ‰çš„è¯ä¼šå—åˆ°æ¯ç§’ 5 æ¬¡çš„è°ƒç”¨é™åˆ¶ï¼‰ã€‚</li>
<li>Json Rpc Providerï¼šè¿æ¥æœ¬åœ°ä»¥å¤ªåŠç½‘ç‚¹çš„ Providerã€‚</li>
<li>Infura Providerï¼šè¿æ¥ Infura ç½‘ç»œçš„ Providerï¼ŒInfura æ˜¯ä¸€å¥—ä»¥å¤ªåŠçš„åŸºç¡€è®¾æ–½æœåŠ¡ï¼ŒåŒæ ·æœ‰ä»¥å¤ªåŠçš„ä¸»ç½‘ç»œå’Œæµ‹è¯•ç½‘ç»œã€‚</li>
<li>Web3 Providerï¼šè¿æ¥å·²æœ‰ web3 å¯¹è±¡çš„ providerã€‚</li>
<li>Fallback Providerï¼šè¿æ¥ä¸€ä¸ªå¯ä»¥æ˜¯å¤šç§ç±»å‹çš„ provider é›†åˆï¼Œå¦‚æœå‰é¢çš„ provider æœ‰é—®é¢˜ï¼Œä¼šè‡ªåŠ¨å»è¿æ¥åé¢çš„ã€‚</li>
</ul>


<h3>Provider network</h3>

<p>åœ¨ Provider åˆ›å»ºæ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªå‚æ•°<code>network</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨ç½‘ç»œåç§°ï¼Œæœ‰å¦‚ä¸‹å€¼ï¼š</p>

<ul>
<li>homestead/mainnetï¼šä»¥å¤ªåŠä¸»ç½‘ç»œ</li>
<li>morden: morden æµ‹è¯•ç½‘ç»œï¼ˆç°åœ¨å·²ç»é€€å½¹äº†ï¼‰</li>
<li>ropsten/testnet: ropsten æµ‹è¯•ç½‘ç»œ</li>
<li>rinkebyï¼šrinkeby æµ‹è¯•ç½‘ç»œ</li>
<li>kovanï¼škovan æµ‹è¯•ç½‘ç»œ</li>
</ul>


<h3>ä¸é’±åŒ…é›†æˆ</h3>

<p>åœ¨é€šè¿‡ç§é’¥åˆ›å»ºé’±åŒ…çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ç§é’¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°å°±æ˜¯ providerï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å°† provider é›†æˆåˆ°é’±åŒ…ä¸­ï¼š</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">providers</span><span class="p">.</span><span class="nx">getDefaultProvider</span><span class="p">();</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Wallet</span><span class="p">(</span><span class="nx">privateKey</span><span class="p">,</span> <span class="nx">provider</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ç»™é’±åŒ…å¯¹è±¡çš„ provider å±æ€§èµ‹å€¼æ¥é›†æˆ providerã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="nx">providers</span><span class="p">.</span><span class="nx">getDefaultProvider</span><span class="p">();</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">wallet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Wallet</span><span class="p">(</span><span class="nx">privateKey</span><span class="p">);</span>
</span><span class='line'><span class="nx">wallet</span><span class="p">.</span><span class="nx">provider</span> <span class="o">=</span> <span class="nx">provider</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>æ™ºèƒ½åˆçº¦</h2>

<p>å…³äºæ™ºèƒ½åˆçº¦åé¢æˆ‘ä¼šå¦å¤–å†™ä¸€ç¯‡æ–‡ç« æ¥ä»‹ç»æ€ä¹ˆä½¿ç”¨ Ethers.js æ¥å®ç°ä»¥å¤ªåŠä»£å¸çš„ä¸šåŠ¡æ“ä½œï¼ŒåŒ…æ‹¬è·å–é‡‘é¢å’Œäº¤æ˜“ç­‰ã€‚</p>

<h2>äº¤æ˜“</h2>

<p>äº¤æ˜“åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œåœ¨é’±åŒ…å¯¹è±¡æœ‰å¯¹åº”çš„æ–¹æ³•ï¼š<code>sendTransaction ( transaction )</code>å’Œ<code>send ( addressOrName, amountWei [ , options ] )</code>ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£ã€‚</p>

<h2>ç”ŸæˆåŠ©è®°è¯</h2>

<p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¸šåŠ¡åœºæ™¯æ˜¯ç”ŸæˆåŠ©è®°è¯ï¼ŒEthers.js ä¹Ÿå¾ˆè´´å¿ƒåœ°æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼š</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">entropy</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">mnemonicTemp</span> <span class="o">=</span> <span class="nx">HDNode</span><span class="p">.</span><span class="nx">entropyToMnemonic</span><span class="p">(</span><span class="nx">entropy</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">walelt</span> <span class="o">=</span> <span class="nx">Wallet</span><span class="p">.</span><span class="nx">fromMnemonic</span><span class="p">(</span><span class="nx">mnemonicTemp</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>å·¥å…·ç±»</h2>

<p>Ethers.js è¿˜æä¾›äº†ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„å·¥å…·æ–¹æ³•ï¼Œæ¯”å¦‚å¯¹ BigNumber çš„æ“ä½œã€‚</p>

<h3>BigNumber è®¡ç®—</h3>

<p>æœ‰äººå¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆéœ€è¦æ“ä½œ BigNumberï¼Ÿå› ä¸ºä»¥å¤ªåŠçš„è®¡é‡å•ä½æ˜¯<code>Wei</code>ï¼Œä¸€ä¸ªä»¥å¤ªå¸æ˜¯ 10<sup>18</sup> Weiï¼Œå¦‚æœç”¨æ™®é€šçš„ JS number å¯¹è±¡æ¥å­˜å‚¨æ“ä½œçš„è¯ï¼Œå¯èƒ½ä¼šå› ä¸ºæ•°æ®æº¢å‡ºè€Œå¯¼è‡´ç»“æœå¼‚å¸¸ã€‚</p>

<p>æ¯”å¦‚å¸¸è§çš„ä¸šåŠ¡åœºæ™¯æ˜¯ï¼šè·å–é’±åŒ…è´¦æˆ·é‡‘é¢ï¼ˆä»¥å¤ªå¸æ•°é‡ï¼‰å¹¶ä¹˜ä»¥è´§å¸å•ä½æ±‡ç‡ï¼ˆç¾å…ƒæˆ–è€…äººæ°‘å¸ï¼‰å¾—åˆ°æœ€ç»ˆç»“æœã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// æ±‡ç‡ï¼Œæˆªæ­¢ 2018-04-29ï¼ŒETH ä»·æ ¼ä¸º 693.01 USD</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">USD_RATE</span> <span class="o">=</span> <span class="mf">693.01</span><span class="p">;</span>
</span><span class='line'><span class="c1">// é’±åŒ…é‡‘é¢</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">balance</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">wallet</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">();</span>
</span><span class='line'><span class="c1">// bigNumber ä¸èƒ½å’Œå°æ•°è¿›è¡Œè®¡ç®—ï¼Œæ‰€ä»¥è¦å…ˆå°†æ±‡ç‡å˜æˆæ•´æ•°</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">rate</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">USD_RATE</span> <span class="o">*</span> <span class="mi">100</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">balance</span><span class="p">.</span><span class="nx">mul</span><span class="p">(</span><span class="nx">rate</span><span class="p">).</span><span class="nx">div</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>BigNumber æ ¼å¼åŒ–</h3>

<p>è®¡ç®—å¥½äº†ç»“æœåï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢æˆæ­£å¸¸çš„æ•°é‡å•ä½å¹¶å±•ç¤ºåˆ°å‰å°ï¼Œè¿˜å¥½ Ethers.js æä¾›äº†ç›¸å…³çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸åŒå‚æ•°å±•ç¤ºä¸åŒæ ¼å¼çš„ç»“æœã€‚</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">const</span> <span class="nx">wei</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">bigNumberify</span><span class="p">(</span><span class="s2">&quot;1000000000000000000000&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">wei</span><span class="p">));</span>
</span><span class='line'><span class="c1">// &quot;1000.0&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">wei</span><span class="p">,</span> <span class="p">{</span><span class="nx">commify</span><span class="o">:</span> <span class="kc">true</span><span class="p">}));</span>
</span><span class='line'><span class="c1">// &quot;1,000.0&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">wei</span><span class="p">,</span> <span class="p">{</span><span class="nx">pad</span><span class="o">:</span> <span class="kc">true</span><span class="p">}));</span>
</span><span class='line'><span class="c1">// &quot;1000.000000000000000000&quot; </span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">wei</span><span class="p">,</span> <span class="p">{</span><span class="nx">commify</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">pad</span><span class="o">:</span> <span class="kc">true</span><span class="p">}));</span>
</span><span class='line'><span class="c1">// &quot;1,000.000000000000000000&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>å…¶ä»–</h3>

<p>å…¶ä»–å·¥å…·æ–¹æ³•è¿˜æœ‰ UTF8 å­—ç¬¦ä¸²è½¬æ¢ï¼Œåœ°å€ icap è½¬æ¢ç­‰ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œå‚è€ƒæ–‡æ¡£ã€‚</p>

<h2>æ€»ç»“</h2>

<p>Ethers.js æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆå¼€å‘ä»¥å¤ªåŠé’±åŒ…åº”ç”¨çš„å·¥å…·åº“ï¼Œè¿™é‡Œä»‹ç»çš„åŠŸèƒ½åªæ˜¯ä»“åº“åŠŸèƒ½çš„å†°å±±ä¸€è§’ï¼Œå¦‚æœéœ€è¦äº†è§£å…¶æ›´å¤šåŠŸèƒ½çš„è¯ï¼Œè¿˜è¯·å‚é˜…å®˜æ–¹æ–‡æ¡£ã€‚</p>
</div>

<div class="meta">
</div>
</article>
  <section id="appreciates">
    <center>
	    <h2>èµèµ</h2>
	    <h4>å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œå¯ä»¥è½¬ç‚¹ ETH ç»™æˆ‘å–å’–å•¡ğŸ˜Œï¼Œé’±åŒ…äºŒç»´ç ï¼š</h4>
      <span>0x0C9b27c89A61aadb0aEC24CA8949910Cbf77Aa73</span>
      <img src="/images/my_eth_qrcode.png" alt="qrcode" width="250" >
    </center>
  </section>
	
		<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

	
	
	<section id="comment">
	    <h2 class="title">Comments</h2>
	    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
	</section>
	
</div>

	    </div>
	    <footer id="footer">
	    <div style="display:inline">
    Copyright &copy; 2018

    èµµèŠæ˜
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


	    </footer>
	    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'zhaozhiming';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://zhaozhiming.github.io/blog/2018/04/25/how-to-use-ethers-dot-js/';
        var disqus_url = 'http://zhaozhiming.github.io/blog/2018/04/25/how-to-use-ethers-dot-js/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




	</div>
	
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
